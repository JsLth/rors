<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ORS Docker instance — ORSDocker • rors</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ORS Docker instance — ORSDocker"><meta name="description" content='Creates a new ORS instance object that operates on a Docker instance of
OpenRouteService. This R6 class is typically constructed by
ors_instance. ORSDocker requires Docker to be
installed on the system and accessible by the current user. If these
requirements cannot be met, consider using ORSJar or
ORSWar.
For technical details on the setup of local ORS instances, refer to the
Running with Docker documentation.
For details on how to use ORSDocker objects, refer to the installation
vignette:

vignette("ors-installation", package = "rors")

'><meta property="og:description" content='Creates a new ORS instance object that operates on a Docker instance of
OpenRouteService. This R6 class is typically constructed by
ors_instance. ORSDocker requires Docker to be
installed on the system and accessible by the current user. If these
requirements cannot be met, consider using ORSJar or
ORSWar.
For technical details on the setup of local ORS instances, refer to the
Running with Docker documentation.
For details on how to use ORSDocker objects, refer to the installation
vignette:

vignette("ors-installation", package = "rors")

'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/ors-installation.html">OpenRouteService setup</a></li>
    <li><a class="dropdown-item" href="../articles/ors-routing.html">Routing functions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JsLth/rors/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ORS Docker instance</h1>
      <small class="dont-index">Source: <a href="https://github.com/JsLth/rors/blob/master/R/docker.R" class="external-link"><code>R/docker.R</code></a></small>
      <div class="d-none name"><code>ORSDocker.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a new ORS instance object that operates on a Docker instance of
OpenRouteService. This R6 class is typically constructed by
<code><a href="ors_instance.html">ors_instance</a></code>. <code>ORSDocker</code> requires Docker to be
installed on the system and accessible by the current user. If these
requirements cannot be met, consider using <code><a href="ORSJar.html">ORSJar</a></code> or
<code><a href="ORSWar.html">ORSWar</a></code>.</p>
<p>For technical details on the setup of local ORS instances, refer to the
<a href="https://giscience.github.io/openrouteservice/run-instance/running-with-docker" class="external-link">Running with Docker documentation</a>.
For details on how to use <code>ORSDocker</code> objects, refer to the installation
vignette:</p>
<div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"ors-installation"</span>, package <span class="op">=</span> <span class="st">"rors"</span><span class="op">)</span></span></code></pre></div>

    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>ORSDocker</code> defines methods for all four steps in the ORS setup:</p><ul><li><p><b>Extract:</b> Download an extract and set it up for graph building.</p></li>
<li><p><b>Compose:</b> Change docker settings that control how the service is set up.</p></li>
<li><p><b>Configuration:</b> Change the way ORS computes routes.</p></li>
<li><p><b>Docker:</b> Send commands to docker to control the ORS container.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="docker-commands">Docker commands<a class="anchor" aria-label="anchor" href="#docker-commands"></a></h2>



<p>Local ORS instances are built using Docker containers. Initializing
<code>ORSLocal</code> downloads a <code>docker-compose.yml</code> file that tells
Docker how to build an ORS container. The Docker backend is pulled as
a Docker image (see
<a href="https://hub.docker.com/r/openrouteservice/openrouteservice" class="external-link">Dockerhub</a>).
<code>rors</code> communicates with Docker from within R to setup and manage ORS
containers.</p>
<p>On Unix systems, Docker requires superuser permissions. In Unix shells,
this is not problematic. However, R cannot communicate with Docker without
explicitly being granted superuser permissions or at least permissions to
access Docker. Thus, <code>ORSLocal</code> checks if the current user is the
superuser or if the current user has access to the Docker group. If not,
it aborts. For more details on how to manage Docker as a non-root user on
Linux, refer to the
<a href="https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user" class="external-link">Docker documentation</a>.
Note that this procedure grants root-level privileges to a user and can
negatively impact your system's security.</p>
    </div>
    <div class="section level2">
    <h2 id="manual-changes">Manual changes<a class="anchor" aria-label="anchor" href="#manual-changes"></a></h2>



<p><code>ORSLocal</code> provides a range of convenience methods to change the
setup of the ORS instance. All of these methods automatically read or write
their changes to disk. It is also possible to make direct changes to the
(parsed) configuration and compose files. In this case, reading and writing
also need to be done manually. To write changes to disk, run
<code>$update()</code>, e.g.:</p>
<div class="sourceCode"><pre><code><span></span>
<span> <span class="va">ors</span><span class="op">$</span><span class="va">compose</span><span class="op">$</span><span class="va">parsed</span><span class="op">$</span><span class="va">services</span><span class="op">$</span><span class="va">`ors-app`</span><span class="op">$</span><span class="va">container_name</span> <span class="op">&lt;-</span> <span class="st">"new-name-123"</span></span>
<span> <span class="va">ors</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>

<p>To read changes done manually to the files on disk, run
<code>$update("self")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="configuration-files">Configuration files<a class="anchor" aria-label="anchor" href="#configuration-files"></a></h2>



<p>Contrary to what is written in the
<a href="https://giscience.github.io/openrouteservice/run-instance/configuration/" class="external-link">ORS documentation</a>,
<code>ORSLocal</code> does not search for a pre-defined configuration file.
Instead, it explicitly creates a configuration file in the runtime directory.
Configurations are passed using an .env file but changes to the
configuration file are done using a .yml file due to easier reading and
writing within R. Accordingly, changes made to the .env file are
overwritten when <code>$update("fs")</code> is called and cannot be read using
<code>$update("self")</code>. All manual changes should be made to the .yml file.
Alternative configuration files can be specified by modifying the
<code>ORS_CONFIG_LOCATION</code> option in the compose file:</p>
<div class="sourceCode"><pre><code><span></span>
<span><span class="va">ors</span><span class="op">$</span><span class="va">compose</span><span class="op">$</span><span class="va">parsed</span><span class="op">$</span><span class="va">services</span><span class="op">$</span><span class="va">`ors-app`</span><span class="op">$</span><span class="va">environment</span><span class="op">$</span><span class="va">ORS_CONFIG_LOCATION</span> <span class="op">&lt;-</span> <span class="st">"ors-config.yml"</span></span>
<span><span class="va">ors</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="ORSInstance.html">rors::ORSInstance</a></code> -&gt; <code><a href="ORSLocal.html">rors::ORSLocal</a></code> -&gt; <code>ORSDocker</code></p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>paths</code></dt>
<dd><p>List of relevant file paths for the ORS setup. Includes
the top directory, compose file, config file, and extract file.</p></dd>


<dt><code>version</code></dt>
<dd><p>Version of the local ORS backend</p></dd>


<dt><code>compose</code></dt>
<dd><p>Information of the compose file (<code>docker-compose.yml</code>).
The compose file holds various settings for the Docker setup. The most
important settings are included in this field:</p>
<ul><li><p><code>ports</code>: A 2×2 matrix with Docker ports</p></li>
<li><p><code>name</code>: Name of the Docker container</p></li>
<li><p><code>memory</code>: List with memory information on total and free
system memory as well as initial and max memory allocated to the Docker
instance.</p></li>
<li><p><code>image</code>: Version of the ORS image. <code>"latest"</code> refers
to the latest stable version. <code>"nightly"</code> refers to the devel
version.</p></li>
<li><p><code>parsed</code>: Parsed compose file. When making changes to this
object, make sure to run <code>$update()</code> to apply the changes. For details,
refer to the <a href="https://giscience.github.io/openrouteservice/run-instance/installation/running-with-docker#docker-configuration" class="external-link">official reference</a>.</p></li>
</ul></dd>


<dt><code>config</code></dt>
<dd><p>Information of the configuration file (<code>ors-config.yml</code>).
The config file holds various options about the ORS instance. This
field gives details about:</p>
<ul><li><p>profiles: A named vector of active routing profiles</p></li>
<li><p>parsed: Parsed configuration file. When making changes to
this obhect, make sure to run <code>$update()</code> to apply the changes.
For details, refer to the
<a href="https://giscience.github.io/openrouteservice/run-instance/configuration/" class="external-link">ORS reference</a>.</p></li>
</ul></dd>


<dt><code>extract</code></dt>
<dd><p>Information on the extract file. Contains the name and
size of the selected extract file.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-ORSDocker-new"><code>ORSDocker$new()</code></a></p></li>
<li><p><a href="#method-ORSDocker-purge"><code>ORSDocker$purge()</code></a></p></li>
<li><p><a href="#method-ORSDocker-set_name"><code>ORSDocker$set_name()</code></a></p></li>
<li><p><a href="#method-ORSDocker-set_port"><code>ORSDocker$set_port()</code></a></p></li>
<li><p><a href="#method-ORSDocker-set_memory"><code>ORSDocker$set_memory()</code></a></p></li>
<li><p><a href="#method-ORSDocker-set_graphbuilding"><code>ORSDocker$set_graphbuilding()</code></a></p></li>
<li><p><a href="#method-ORSDocker-set_image"><code>ORSDocker$set_image()</code></a></p></li>
<li><p><a href="#method-ORSDocker-up"><code>ORSDocker$up()</code></a></p></li>
<li><p><a href="#method-ORSDocker-down"><code>ORSDocker$down()</code></a></p></li>
<li><p><a href="#method-ORSDocker-start"><code>ORSDocker$start()</code></a></p></li>
<li><p><a href="#method-ORSDocker-stop"><code>ORSDocker$stop()</code></a></p></li>
<li><p><a href="#method-ORSDocker-get_image"><code>ORSDocker$get_image()</code></a></p></li>
<li><p><a href="#method-ORSDocker-get_container"><code>ORSDocker$get_container()</code></a></p></li>
<li><p><a href="#method-ORSDocker-show_logs"><code>ORSDocker$show_logs()</code></a></p></li>
<li><p><a href="#method-ORSDocker-is_built"><code>ORSDocker$is_built()</code></a></p></li>
<li><p><a href="#method-ORSDocker-is_running"><code>ORSDocker$is_running()</code></a></p></li>
<li><p><a href="#method-ORSDocker-is_init"><code>ORSDocker$is_init()</code></a></p></li>
<li><p><a href="#method-ORSDocker-clone"><code>ORSDocker$clone()</code></a></p></li>
</ul></div><p><details><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="rors" data-topic="ORSInstance" data-id="get_status"><a href="ORSInstance.html#method-get_status"><code>rors::ORSInstance$get_status()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSInstance" data-id="get_url"><a href="ORSInstance.html#method-get_url"><code>rors::ORSInstance$get_url()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSInstance" data-id="is_mounted"><a href="ORSInstance.html#method-is_mounted"><code>rors::ORSInstance$is_mounted()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSInstance" data-id="is_ready"><a href="ORSInstance.html#method-is_ready"><code>rors::ORSInstance$is_ready()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="add_profiles"><a href="ORSLocal.html#method-add_profiles"><code>rors::ORSLocal$add_profiles()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="report"><a href="ORSLocal.html#method-report"><code>rors::ORSLocal$report()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="rm_extract"><a href="ORSLocal.html#method-rm_extract"><code>rors::ORSLocal$rm_extract()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="rm_profiles"><a href="ORSLocal.html#method-rm_profiles"><code>rors::ORSLocal$rm_profiles()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="set_endpoints"><a href="ORSLocal.html#method-set_endpoints"><code>rors::ORSLocal$set_endpoints()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="set_extract"><a href="ORSLocal.html#method-set_extract"><code>rors::ORSLocal$set_extract()</code></a></span></li>
<li><span class="pkg-link" data-pkg="rors" data-topic="ORSLocal" data-id="update"><a href="ORSLocal.html#method-update"><code>rors::ORSLocal$update()</code></a></span></li>
</ul></details></p><hr><a id="method-ORSDocker-new"></a><div class="section">
<h3 id="method-new-">Method <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialize the ORSDocker object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/ORSDocker.html">ORSDocker</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  dir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prompts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>dir</code></dt>
<dd><p><code>[character]</code></p>
<p>Custom OpenRouteService directory. If not specified, the compose file
will be downloaded to the current working directory. If a directory called
<code>"openrouteservice-{version}"</code> is present, the download will be skipped.
Ignored if <code>server</code> is not <code>NULL</code>.</p></dd>


<dt><code>version</code></dt>
<dd><p><code>[character]</code></p>
<p>The OpenRouteService version to use. Can either be a version number (e.g.
8.1.1) or <code>"master"</code>. Defaults to the most recent supported version.</p></dd>


<dt><code>overwrite</code></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to overwrite the current OpenRouteService directory if it exists.</p></dd>


<dt><code>dry</code></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to start a dry instance, i.e. initialize a docker instance without
requiring docker. This allows you to manipulate config, compose file,
and extract but does not allow you to interact with docker.</p></dd>


<dt><code>verbose</code></dt>
<dd><p><code>[logical]</code></p>
<p>Level of verbosity. If <code>TRUE</code>, shows informative warnings and messages,
spinners, progress bars and system notifications.</p></dd>


<dt><code>prompts</code></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to ask for permission throughout the setup. Defaults to
<code>TRUE</code> in interactive sessions.</p></dd>


<dt><code>...</code></dt>
<dd><p>Not used.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-purge"></a><div class="section">
<h3 id="method-purge-">Method <code>purge()</code><a class="anchor" aria-label="anchor" href="#method-purge-"></a></h3>
<p>Purge ORS instance, i.e. take down container, (optionally) delete
image, delete ORS directory, and clean up R6 class.</p>
<p>This method can be useful for testing and writing reproducible
examples and can easily be used together with <code><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></code>.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">purge</span><span class="op">(</span>image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>image</code></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to remove the docker image or keep it for other projects. The
default is <code>FALSE</code> to prevent accidentally breaking other projects.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-set_name"></a><div class="section">
<h3 id="method-set-name-">Method <code>set_name()</code><a class="anchor" aria-label="anchor" href="#method-set-name-"></a></h3>
<p>Set a name for the ORS container.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">set_name</span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name for the ORS container. If <code>NULL</code>, generates
a random name (<code>"ors-appXXXX"</code>).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-set_port"></a><div class="section">
<h3 id="method-set-port-">Method <code>set_port()</code><a class="anchor" aria-label="anchor" href="#method-set-port-"></a></h3>
<p>Set a port for the localhost of the ORS container.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">set_port</span><span class="op">(</span>port <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>port</code></dt>
<dd><p><code>[numeric]</code>/<code>NULL</code></p>
<p>Port to use for the container. Can be a vector of length 1 or 2.
The first port is for the API, the second port is optionally for
additional monitoring. If <code>NULL</code>, assigns a random port using
<code><a href="https://rdrr.io/pkg/httpuv/man/randomPort.html" class="external-link">randomPort()</a></code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-set_memory"></a><div class="section">
<h3 id="method-set-memory-">Method <code>set_memory()</code><a class="anchor" aria-label="anchor" href="#method-set-memory-"></a></h3>
<p>Set initial and max memory that the ORS container is allowed to use.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">set_memory</span><span class="op">(</span>init <span class="op">=</span> <span class="cn">NULL</span>, max <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>init</code></dt>
<dd><p><code>[numeric/NULL]</code></p>
<p>Initial memory. This can change if more memory is needed. If not
specified, uses <code>max</code>. If both are <code>NULL</code>, estimates
memory.</p></dd>


<dt><code>max</code></dt>
<dd><p><code>[numeric/NULL]</code></p>
<p>Maximum memory. The container is not allowed to use more
memory than this value. If not specified, uses <code>init</code>. If both are
<code>NULL</code>, estimates memory.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-set_graphbuilding"></a><div class="section">
<h3 id="method-set-graphbuilding-">Method <code>set_graphbuilding()</code><a class="anchor" aria-label="anchor" href="#method-set-graphbuilding-"></a></h3>
<p>Graph building specifies whether routing graphs should be (re-)built.
Turning graph building on enables new profiles to be built or the
extract to be changed but significantly increases setup time. Turn
this off if you are changing configuration options that do not alter
routing graphs.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">set_graphbuilding</span><span class="op">(</span><span class="va">mode</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>mode</code></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to turn graph building on or off.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-set_image"></a><div class="section">
<h3 id="method-set-image-">Method <code>set_image()</code><a class="anchor" aria-label="anchor" href="#method-set-image-"></a></h3>
<p>Set version of the ORS Docker image. This should preferably be compatible
with the compose version.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">set_image</span><span class="op">(</span><span class="va">version</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>version</code></dt>
<dd><p><code>[character]</code></p>
<p>Version specification of the ORS image.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-up"></a><div class="section">
<h3 id="method-up-">Method <code>up()</code><a class="anchor" aria-label="anchor" href="#method-up-"></a></h3>
<p>Create the ORS docker container and setup the ORS backend on a local
host.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span>wait <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>wait</code></dt>
<dd><p><code>logical</code></p>
<p>Whether to run a spinner and show a system notification when the setup
is completed. If <code>FALSE</code> releases the console after the Docker
container is created. You can then check the service status using
<code>$is_ready()</code>.</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional flags passed to the <code>docker up</code> command.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>The exact command run by <code>$up()</code> is:</p>
<p><code>docker compose -p [name] -f [compose file] up -d --no-build [...]</code></p>
<p>The <code>-p</code> flag allows docker to run multiple ORS containers and keep
them separate. It uses the service name defined in the compose file.</p>
<p>If not found, <code>$up()</code> builds the underlying OpenRouteService docker
image specified by <code>version</code> during the initialization of
<code>ORSLocal</code>.</p>
<p>Usually in detach mode (<code>-d</code>), docker returns terminal control back
to the user. By default, <code>$up()</code> blocks the console, checks for
errors and notifies the user when the service setup has finished. This
behavior can be suppresed by setting <code>wait = FALSE</code>. The service
status can then be checked using <code>$is_ready()</code> or
<code><a href="get_instance.html">ors_ready()</a></code>. Container logs can be accessed by typing
<code>docker logs [name]</code> in the terminal.</p>
</div>


</div><p></p><hr><a id="method-ORSDocker-down"></a><div class="section">
<h3 id="method-down-">Method <code>down()</code><a class="anchor" aria-label="anchor" href="#method-down-"></a></h3>
<p>Stop and remove the ORS docker container. Use this if you want to make
changes to a running ORS setup such as changing the extract or selected
profiles.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">down</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-start"></a><div class="section">
<h3 id="method-start-">Method <code><a href="https://rdrr.io/r/stats/start.html" class="external-link">start()</a></code><a class="anchor" aria-label="anchor" href="#method-start-"></a></h3>
<p>Start the ORS docker container.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">start</span><span class="op">(</span>wait <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>wait</code></dt>
<dd><p><code>logical</code></p>
<p>Whether to run a spinner and show a system notification when the setup
is completed. If <code>FALSE</code> releases the console after the Docker
container is created. You can then check the service status using
<code>$is_ready()</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-stop"></a><div class="section">
<h3 id="method-stop-">Method <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code><a class="anchor" aria-label="anchor" href="#method-stop-"></a></h3>
<p>Stop the ORS docker container.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-get_image"></a><div class="section">
<h3 id="method-get-image-">Method <code>get_image()</code><a class="anchor" aria-label="anchor" href="#method-get-image-"></a></h3>
<p>Retrieve technical information on the docker image used.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">get_image</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-get_container"></a><div class="section">
<h3 id="method-get-container-">Method <code>get_container()</code><a class="anchor" aria-label="anchor" href="#method-get-container-"></a></h3>
<p>Retrieve technical information on the docker container used.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">get_container</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-show_logs"></a><div class="section">
<h3 id="method-show-logs-">Method <code>show_logs()</code><a class="anchor" aria-label="anchor" href="#method-show-logs-"></a></h3>
<p>Show container logs as returned by <code>docker logs</code>. Useful for
debugging docker setups.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">show_logs</span><span class="op">(</span>format <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>format</code></dt>
<dd><p><code>[logical]</code></p>
<p>If <code>TRUE</code>, includes ANSI colors and adds exdents. Otherwise,
trims ANSI colors. Disabling formatting increases performance, which
can be useful for larger logs.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-ORSDocker-is_built"></a><div class="section">
<h3 id="method-is-built-">Method <code>is_built()</code><a class="anchor" aria-label="anchor" href="#method-is-built-"></a></h3>
<p>Checks if the ORS container is built. You can control this state
using <code>$up()</code> and <code>$down()</code>.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">is_built</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-is_running"></a><div class="section">
<h3 id="method-is-running-">Method <code>is_running()</code><a class="anchor" aria-label="anchor" href="#method-is-running-"></a></h3>
<p>Checks if the ORS container is running. You can control this state
using <code>$start()</code> and <code>$stop()</code>. Check <code>$is_ready()</code> to see
if the ORS setup succeeded.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">is_running</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-is_init"></a><div class="section">
<h3 id="method-is-init-">Method <code>is_init()</code><a class="anchor" aria-label="anchor" href="#method-is-init-"></a></h3>
<p>Checks if ORS is initialized. ORS is initialized if it was built
for the first time. An initialized ORS instance has a subdirectory
called <code>"graphs"</code> that contains built graphs for at least one
routing profile. <code>$is_init()</code> therefore checks for the
existence of at least one sub-directory of <code>"graphs"</code>.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">is_init</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-ORSDocker-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">ORSDocker</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Download ORS, start docker and jumpstart a default session</span></span></span>
<span class="r-in"><span><span class="va">ors</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_instance.html">ors_instance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set a new extract file</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_extract</span><span class="op">(</span><span class="st">"Rutland"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Allocate 100 MB of RAM</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_ram</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a routing profile</span></span></span>
<span class="r-in"><span><span class="va">walking</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_profile.html">ors_profile</a></span><span class="op">(</span><span class="st">"walking"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">add_profiles</span><span class="op">(</span><span class="va">walking</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set random port</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_port</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change project name</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_name</span><span class="op">(</span><span class="st">"example-ors"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set up ORS</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check if ORS container exists and is running</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">is_built</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">is_running</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check if ORS is ready to use</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">is_ready</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stop container, e.g. to make configuration changes</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make changes to the configuration</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_endpoints</span><span class="op">(</span>matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maximum_routes <span class="op">=</span> <span class="fl">1e+05</span><span class="op">)</span><span class="op">)</span> <span class="co"># default is 2500</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change default profile settings</span></span></span>
<span class="r-in"><span><span class="va">default</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_profile.html">ors_profile</a></span><span class="op">(</span>maximum_snapping_radius <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">add_profiles</span><span class="op">(</span><span class="va">default</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If we make manual changes to the configuration, we need to apply the</span></span></span>
<span class="r-in"><span><span class="co"># changes explicitly</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">parsed</span><span class="op">$</span><span class="va">ors</span><span class="op">$</span><span class="va">engine</span><span class="op">$</span><span class="va">profiles</span><span class="op">$</span><span class="va">car</span><span class="op">$</span><span class="va">elevation</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span><span class="op">)</span> <span class="co"># writes the current object state to the disk</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the compose or config files are changed on disk, the object can be</span></span></span>
<span class="r-in"><span><span class="co"># refreshed</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span><span class="st">"self"</span><span class="op">)</span> <span class="co"># reads the disk state to the R object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding profiles does not work when the container is still built!</span></span></span>
<span class="r-in"><span><span class="co"># Why? Because graphs need to be built for new profiles, so the container</span></span></span>
<span class="r-in"><span><span class="co"># must be down.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">bike</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_profile.html">ors_profile</a></span><span class="op">(</span><span class="st">"bike-road"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ors</span><span class="op">$</span><span class="fu">add_profiles</span><span class="op">(</span><span class="va">bike</span><span class="op">)</span> <span class="co"># only do this when the container is down!!</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additionally, graphs are only re-built if we enable graph building.</span></span></span>
<span class="r-in"><span><span class="co"># When changing the extract, this happens automatically, but we can also</span></span></span>
<span class="r-in"><span><span class="co"># control graph building manually, e.g. for adding new profiles.</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_graphbuilding</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally, start the container again to run the newly configured service</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">start</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

