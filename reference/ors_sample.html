<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ORS-based sampling — ors_sample • rors</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ORS-based sampling — ors_sample"><meta name="description" content="Sample point geometries within the boundaries of the running
ORS extract. This function works by reading in the mounted extract file and
can thus only be run with a local instance."><meta property="og:description" content="Sample point geometries within the boundaries of the running
ORS extract. This function works by reading in the mounted extract file and
can thus only be run with a local instance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/ors-installation.html">OpenRouteService setup</a></li>
    <li><a class="dropdown-item" href="../articles/ors-routing.html">Routing functions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JsLth/rors/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ORS-based sampling</h1>
      <small class="dont-index">Source: <a href="https://github.com/JsLth/rors/blob/master/R/sample.R" class="external-link"><code>R/sample.R</code></a></small>
      <div class="d-none name"><code>ors_sample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample point geometries within the boundaries of the running
ORS extract. This function works by reading in the mounted extract file and
can thus only be run with a local instance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ors_sample</span><span class="op">(</span></span>
<span>  <span class="va">size</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  instance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  poly <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_extract_boundaries</span><span class="op">(</span>instance <span class="op">=</span> <span class="cn">NULL</span>, force <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p><code>[integer]</code></p>
<p>Number of points to be sampled.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Passed to <code><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></code>.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p><code>[logical]</code></p>
<p>If <code>TRUE</code>, forces the cached extract geometries to be overwritten.
Defaults to <code>FALSE</code> to increase speed. Set this to <code>TRUE</code> if the
extract has changed and a new one needs to be loaded.</p></dd>


<dt id="arg-instance">instance<a class="anchor" aria-label="anchor" href="#arg-instance"></a></dt>
<dd><p><code>[ors_instance]</code></p>
<p>Object of an OpenRouteService instance that should be used for route
computations. It is recommended to use <code><a href="ors_instance.html">ors_instance</a></code>
to set an instance globally. This argument should only be used if activating
an instance globally is not feasible.</p></dd>


<dt id="arg-poly">poly<a class="anchor" aria-label="anchor" href="#arg-poly"></a></dt>
<dd><p><code>[sf/sfc]</code></p>
<p>Boundary polygon used to sample points. If <code>NULL</code>, the default, boundary
polygons are extracted from the current instance as set by
<code><a href="ors_instance.html">ors_instance</a></code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>[logical]</code></p>
<p>If <code>TRUE</code>, prints a loading spinner.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ors_sample</code> returns an <code>sfc</code> object containing the
sampled <code>POINT</code> geometries. <code>get_extract_boundaries</code> returns an
<code>sfc</code> object of the currently mounted extract boundaries.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function vectortranslates the extract file to an <code>sf</code> object.
Depending on the file, this can take a while. The unionized boundaries are
then cached making subsequent function calls a lot faster.</p>
<p>If <code>instance</code> is not local, it is more difficult to derive the
extract boundaries. There is thus far no way of accessing an OSM extract file
knowing only the server address. We can, however, make use of some
heuristics: <code><a href="ors_export.html">ors_export</a></code> can export the built graphs from an ORS
server if it allows it. However, it does not work on the public API and it
requires knowledge about the approximate area of an extract.
<code><a href="ors_guess.html">ors_guess</a></code> can make an approximation of an extract area. It
accesses the snap endpoint which also does not work on the public API and
needs to be enabled on other servers. <code>ors_guess</code> can make a lot of
requests and might not be feasible in many situations.</p>
    </div>
    <div class="section level2">
    <h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a></h2>



<p>The following functions make use of a runtime caching system:
<code><a href="get_instance.html">ors_ready()</a></code>, <code><a href="get_instance.html">ors_status()</a></code>, <code><a href="get_instance.html">get_profiles()</a></code>,
<code>get_extract_boundaries()</code>, <code>ors_sample()</code>. This means that,
if <code>force = FALSE</code>, previously generated output is re-used instead
of sending new requests. This can be particularly useful in automated
workflows like loops where speed is important. When run directly, caching
should not be necessary, which is why <code>force = FALSE</code> is the default
of most of these functions (except <code>get_extract_boundaries()</code> because
it deals with potentially much larger amounts of data).</p>
<p>"Runtime" in this context refers to the runtime of an ORS instance, i.e.
the time after it is started. Cached results should only be valid for a
specific runtime and discarded afterwards. When mounting a new instance
different from the one mounted before, the runtime cache is cleared
so that fresh requests must be made.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># ORS sampling only works with a local instance</span></span></span>
<span class="r-in"><span><span class="va">monaco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"setup/monaco.pbf"</span>, package <span class="op">=</span> <span class="st">"rors"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_instance.html">ors_instance</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">set_extract</span><span class="op">(</span>file <span class="op">=</span> <span class="va">monaco</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ors</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reads in boundaries of monaco pbf file</span></span></span>
<span class="r-in"><span><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu">get_extract_boundaries</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bounds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># subsequent calls do not need to read the pbf file</span></span></span>
<span class="r-in"><span><span class="fu">ors_sample</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... except when they are forced to</span></span></span>
<span class="r-in"><span><span class="fu">ors_sample</span><span class="op">(</span>force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

