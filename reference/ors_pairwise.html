<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Pairwise routing — ors_pairwise • rors</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise routing — ors_pairwise"><meta name="description" content="ors_pairwise calculates the pairwise routing distance between two
datasets using the Directions service from ORS. In other words, routes
are computed between the ith row of src and dst,
respectively.
ors_shortest_distances is a wrapper around ors_pairwise that
matches each point of the source dataset to a destination dataset
and then extracts the route with the shortest distance."><meta property="og:description" content="ors_pairwise calculates the pairwise routing distance between two
datasets using the Directions service from ORS. In other words, routes
are computed between the ith row of src and dst,
respectively.
ors_shortest_distances is a wrapper around ors_pairwise that
matches each point of the source dataset to a destination dataset
and then extracts the route with the shortest distance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/ors-installation.html">OpenRouteService setup</a></li>
    <li><a class="dropdown-item" href="../articles/ors-routing.html">Routing functions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JsLth/rors/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pairwise routing</h1>
      <small class="dont-index">Source: <a href="https://github.com/JsLth/rors/blob/master/R/pairwise.R" class="external-link"><code>R/pairwise.R</code></a></small>
      <div class="d-none name"><code>ors_pairwise.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ors_pairwise</code> calculates the pairwise routing distance between two
datasets using the Directions service from ORS. In other words, routes
are computed between the <em>i</em>th row of <code>src</code> and <code>dst</code>,
respectively.</p>
<p><code>ors_shortest_distances</code> is a wrapper around <code>ors_pairwise</code> that
matches each point of the source dataset to a destination dataset
and then extracts the route with the shortest distance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ors_pairwise</span><span class="op">(</span></span>
<span>  <span class="va">src</span>,</span>
<span>  <span class="va">dst</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"km"</span>, <span class="st">"mi"</span><span class="op">)</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  instance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ors_shortest_distances</span><span class="op">(</span></span>
<span>  <span class="va">src</span>,</span>
<span>  <span class="va">dst</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"km"</span>, <span class="st">"mi"</span><span class="op">)</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  instance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  proximity_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"duration"</span>, <span class="st">"distance"</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-src">src<a class="anchor" aria-label="anchor" href="#arg-src"></a></dt>
<dd><p><code>[sf/sfc]</code></p>
<p>Source dataset containing point geometries that should be routed from.</p></dd>


<dt id="arg-dst">dst<a class="anchor" aria-label="anchor" href="#arg-dst"></a></dt>
<dd><p><code>[sf/sfc]</code></p>
<p>Destination dataset containing point geometries that should be routed to.
For <code>ors_shortest_distances</code>, the destination argument can also
be a dataframe containing a grouping column specified by the <code>group</code>
argument that indicates which destinations refer to which row in the source
dataset (as returned by <code><a href="group_by_proximity.html">group_by_proximity</a></code>). This is
recommended for large datasets because passing a plain sf dataframe routes
from each source point to each point in the entire destination dataset.</p></dd>


<dt id="arg-profile">profile<a class="anchor" aria-label="anchor" href="#arg-profile"></a></dt>
<dd><p><code>[character]</code></p>
<p>Means of transport as supported by OpenRouteService.
Defaults to the first profile in a call to <code><a href="get_instance.html">get_profiles</a></code>.
For <code>ors_shortest_distances</code>, <code>profile</code> can be a character
vector, for all other functions it needs to be a character scalar.
For details on all profiles, refer to the
<a href="https://giscience.github.io/openrouteservice/technical-details/tag-filtering" class="external-link">backend reference</a>.</p></dd>


<dt id="arg-units">units<a class="anchor" aria-label="anchor" href="#arg-units"></a></dt>
<dd><p><code>[character]</code></p>
<p>Distance unit for distance calculations (<code>"m"</code>, <code>"km"</code> or
<code>"mi"</code>)</p></dd>


<dt id="arg-geometry">geometry<a class="anchor" aria-label="anchor" href="#arg-geometry"></a></dt>
<dd><p><code>[logical]</code></p>
<p>If <code>TRUE</code>, returns a <code>sf</code> object containing route geometries. If
<code>FALSE</code>, returns route distance measures. Defaults to <code>FALSE</code>, to
increase performance.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p><code>[logical]</code></p>
<p>Whether to show a progress bar for longer operations.</p></dd>


<dt id="arg-instance">instance<a class="anchor" aria-label="anchor" href="#arg-instance"></a></dt>
<dd><p><code>[ors_instance]</code></p>
<p>Object of an OpenRouteService instance that should be used for route
computations. It is recommended to use <code><a href="ors_instance.html">ors_instance</a></code>
to set an instance globally. This argument should only be used if activating
an instance globally is not feasible.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the ORS API. Convenience way to
directly pass arguments of <code><a href="ors_params.html">ors_params</a></code>.</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>List of additional arguments passed to the ORS API. See
<code><a href="ors_params.html">ors_params</a></code> for details.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p><code>[character/numeric]</code></p>
<p>Column name or index providing a grouping column that indicates which row
in the destination dataset corresponds to which row in the source dataset
(as in the output of <code><a href="group_by_proximity.html">group_by_proximity</a></code>). Providing
a grouping column can considerably reduce the processing load for larger
datasets.</p></dd>


<dt id="arg-proximity-type">proximity_type<a class="anchor" aria-label="anchor" href="#arg-proximity-type"></a></dt>
<dd><p><code>[character]</code></p>
<p>Type of proximity that the calculations should be
based on. If <code>distance</code>, the shortest physical distance will be calculated
and if <code>duration</code>, the shortest temporal distance will be calculated.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ors_pairwise</code> returns a dataframe with distances and
travel durations between source and destination. Distances are specified
in the unit given by the <code>units</code> arguments and durations are specified
in seconds.</p>
<p><code>ors_shortest_distances</code> returns a dataframe containing distances,
travel durations and the index number of the point of interest with the
shortest routing distance to the respective place of the source dataset.</p>
<p>Depending on the <code>geometry</code> argument, the output of both functions can
either be simple dataframes or objects of class <code>sf</code> containing the
linestring geometries of the respective routes.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For <code>ors_pairwise</code>, the profile argument supports only length-1
vectors while <code>ors_shortest_distances</code> supports multiple profiles.
<code>ors_shortest_distances</code> finds the shortest route for each source
point and each profile, respectively.</p>
<p>Responses are kept as small as possible by automatically setting the
<code>navigation</code> parameter to <code>FALSE</code>. Pairwise computations
only exploit route summary statistics and do not benefit from any extra
information.</p>
    </div>
    <div class="section level2">
    <h2 id="error-handling">Error handling<a class="anchor" aria-label="anchor" href="#error-handling"></a></h2>


<p>Since <code>ors_pairwise</code> is supposed to conduct a lot of calculations
in one go, errors might occur even in well-conceived service setups. In
order to make debugging less painful, errors do not tear down the whole
process. They are saved to an environment and issue a warning containing the
indices of the routes in question. After the process has finished, they can
be accessed by calling <code><a href="last_ors_conditions.html">last_ors_conditions</a></code>. Specific routes
can be examined by inspecting its route attributes using
<code><a href="ors_inspect.html">ors_inspect</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="get_instance.html">any_mounted</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="get_instance.html">ors_ready</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pharma"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dest</span> <span class="op">&lt;-</span> <span class="fu"><a href="ors_sample.html">ors_sample</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">car</span> <span class="op">&lt;-</span> <span class="st">"driving-car"</span></span></span>
<span class="r-in"><span>  <span class="va">bike</span> <span class="op">&lt;-</span> <span class="st">"cycling-regular"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Running with sf objects</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_pairwise</span><span class="op">(</span><span class="va">pharma</span>, <span class="va">dest</span>, profile <span class="op">=</span> <span class="va">car</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Running with coordinate pairs</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_pairwise</span><span class="op">(</span><span class="va">pharma</span>, <span class="va">dest</span>, profile <span class="op">=</span> <span class="va">bike</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Returns route geometries</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_pairwise</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pharma</span>,</span></span>
<span class="r-in"><span>    <span class="va">dest</span>,</span></span>
<span class="r-in"><span>    profile <span class="op">=</span> <span class="va">car</span>,</span></span>
<span class="r-in"><span>    geometry <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Returns routes in kilometers</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_pairwise</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pharma</span>,</span></span>
<span class="r-in"><span>    <span class="va">dest</span>,</span></span>
<span class="r-in"><span>    profile <span class="op">=</span> <span class="va">bike</span>,</span></span>
<span class="r-in"><span>    units <span class="op">=</span> <span class="st">"km"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Running with additional arguments</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_pairwise</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pharma</span>,</span></span>
<span class="r-in"><span>    <span class="va">dest</span>,</span></span>
<span class="r-in"><span>    profile <span class="op">=</span> <span class="va">car</span>,</span></span>
<span class="r-in"><span>    continue_straight <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    preference <span class="op">=</span> <span class="st">"fastest"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Finding shortest routes from each point in sample_a to sample_b</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_shortest_distances</span><span class="op">(</span><span class="va">pharma</span>, <span class="va">dest</span>, units <span class="op">=</span> <span class="st">"km"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Pre-filter the nearest 5 destination points by Euclidian distance</span></span></span>
<span class="r-in"><span>  <span class="va">pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="group_by_proximity.html">group_by_proximity</a></span><span class="op">(</span><span class="va">pharma</span>, <span class="va">dest</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Only route from each pharmacy to one of the closest 5 destination points</span></span></span>
<span class="r-in"><span>  <span class="co"># respectively. For larger datasets, this can increase performance.</span></span></span>
<span class="r-in"><span>  <span class="fu">ors_shortest_distances</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pharma</span>,</span></span>
<span class="r-in"><span>    <span class="va">pois</span>,</span></span>
<span class="r-in"><span>    group <span class="op">=</span> <span class="st">".group"</span>,</span></span>
<span class="r-in"><span>    geometry <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

